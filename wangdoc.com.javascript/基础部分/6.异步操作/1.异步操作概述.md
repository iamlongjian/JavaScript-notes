### 概述
#### (1)单线程模式
- 单线程模型指的是，JavaScript 只在一个线程上运行。也就是说，JavaScript 同时只能执行一个任务，其他任务都必须在后面排队等待。注意，JavaScript 只在一个线程上运行，不代表 JavaScript 引擎只有一个线程。事实上，JavaScript 引擎有多个线程，单个脚本只能在一个线程上运行（称为主线程），其他线程都是在后台配合。
- JavaScript 之所以采用单线程，而不是多线程，跟历史有关系。JavaScript 从诞生起就是单线程，原因是不想让浏览器变得太复杂，因为多线程需要共享资源、且有可能修改彼此的运行结果，对于一种网页脚本语言来说，这就太复杂了。如果 JavaScript 同时有两个线程，一个线程在网页 DOM 节点上添加内容，另一个线程删除了这个节点，这时浏览器应该以哪个线程为准？是不是还要有锁机制？所以，为了避免复杂性，JavaScript 一开始就是单线程，这已经成了这门语言的核心特征，将来也不会改变。
#### (2)同步任务和异步任务
- 程序里面所有的任务可以分为两类:同步任务（synchronous）和异步任务（asynchronous）
- 两者的区别:同步任务执行的时候是一个个执行的,异步任务不用等待异步任务结束,会立即运行。也就是说，异步任务不具有”堵塞“效应。
- 举例来说，Ajax 操作可以当作同步任务处理，也可以当作异步任务处理，由开发者决定。如果是同步任务，主线程就等着 Ajax 操作返回结果，再往下执行；如果是异步任务，主线程在发出 Ajax 请求以后，就直接往下执行，等到 Ajax 操作有了结果，主线程再执行对应的回调函数。
#### (3)任务队列和事件循环
- JavaScript在运行时,除了一个正在运行的主线程,引擎还提供一个任务队列,里面是各种需要当前程序处理的异步任务。
- 首先,主线程会去执行所有的同步任务,等到同步任务全部执行完,就会去看任务队列里面的异步任务。如果满足条件,那么异步任务就重新进入主线程开始执行,这时它就变成同步任务了。等到执行完,下一个异步任务再进入主线程开始执行。一旦任务队列清空,程序就结束执行。
#### (4)异步操作的模式
##### 4.1 回调函数
- 回调函数是异步操作最基本的方法
```
//下面是两个函数f1和f2,编程的意图是f2必须等到f1执行完成,才可以执行
function f1(){
    //...
}
function f2(){
    //...
}
f1();
f2();
// 上面代码的问题在于，如果f1是异步操作，f2会立即执行，不会等到f1结束再执行。
// 这时,可以考虑改写f1,把f2写成f1的回调函数
function f1(callback){
    //...
    callback();
}
function f2(){
    //...
}
f1(f2);
//回调函数的优点是简单、容易理解和实现，缺点是不利于代码的阅读和维护，各个部分之间高度耦合（coupling），使得程序结构混乱、流程难以追踪（尤其是多个回调函数嵌套的情况），而且每个任务只能指定一个回调函数。
```
##### 4.2 事件监听
- 另一种思路是采用事件驱动模式,异步任务的执行不取决于代码的顺序,而取决与于某个事件是否发生
- 还是以f1和f2为例,首先为f1绑定一个事件。
```
f1.addEventListener('click',f2);
```
**上面代码的意思是:当f1发生click事件,就执行f2**
- 对f1进行改写
```
function f1(){
    setTimeout(function(){
        //...
        f1.trigger('click');
    },1000);
}
```
**上面代码的意思是:f1.trigger('click')表示执行完成后,立即触发click事件,从而开始执行f2**
##### 4.3 发布/订阅
- 事件完全可以理解成”信号“，如果存在一个”信号中心“，某个任务执行完成，就向信号中心”发布“（publish）一个信号，其他任务可以向信号中心”订阅“（subscribe）这个信号，从而知道什么时候自己可以开始执行。这就叫做”发布/订阅模式”（publish-subscribe pattern），又称“观察者模式”（observer pattern）。
#### 5.异步操作的流程控制
##### 三种方式：
1. 串行执行：我们可以编写一个流程控制函数，让它来控制异步任务，一个任务完成以后，再执行另一个。这就叫串行执行。
2. 并行执行：流程控制函数也可以是并行执行，即所有异步任务同时执行，等到全部完成以后，才执行final函数。
3. 并行与串行的结合 (推荐使用)：所谓并行与串行的结合，就是设置一个门槛，每次最多只能并行执行n个异步任务，这样就避免了过分占用系统资源。